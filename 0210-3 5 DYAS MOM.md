# 5 DYAS MOM — 策略邏輯

**輸入**
- 價格序列：收盤價序列 `P_t`。
- 參數：窗口長度 `n`、進出場閾值 `θ`、最大持倉比例 `max_pos`、停損比率 `stop_pct`、槓桿/規模係數 `k`。

**輸出**
- 每一時刻的交易指令：`{signal ∈ {BUY, SELL, HOLD}, size ∈ [0, max_pos]}`。

**核心規則（極簡）**
1. 計算 n 期動量：

   $$m_t = \frac{P_t}{P_{t-n}} - 1$$

2. 產生信號：
- 若 `m_t >= θ` 且 當前無多單 → 發出 `BUY`；持倉大小按比例給定：`size = min(max_pos, k * m_t)`。
- 若 `m_t <= -θ` 或 已達停損 → 發出 `SELL`（全部或部分平倉），否則 `HOLD`。

3. 風險控管（必須執行）：
- 停損：若持倉虧損達 `stop_pct` → 強制 `SELL`。
- 每筆交易限制最大持倉 `max_pos`、每日交易次數上限（預設 1）。

4. 成交假設：使用市價成交（或限價於下一可用價位），考慮滑價與手續費於回測中調整結果。

**參數預設（可調）**
- `n = 5`
- `θ = 0.02`（2%）
- `max_pos = 1.0`（100%）
- `stop_pct = 0.05`（5%）
- `k = 0.5`

