# N日 M檔選股策略

## 核心邏輯

動能選股策略。以特定N日報酬率為選股依據，結合成交量及技術指標雙重濾網，每5個交易日進行一次投資組合再平衡。

## 選股機制

1. **報酬率計算**  
   計算個股特定N日期間報酬率(可單週期或多週期平均)，篩選報酬率最高之Top K檔股票。

2. **成交量濾網**  
   僅納入過去某交易日成交金額(元) ≥ V_Bar(千萬)之股票為選股候選池。

3. **技術濾網**  
   排除60日乖離率 > Bias60_Bar之股票，避免逆勢追高。

## 交易規則

- **選股週期**：每5個交易日執行一次再平衡  
- **持倉上限**：維持Top K檔股票  
- **停損機制**：跌幅達Pct_Stp(%)時自動賣出  
- **再平衡**：現有持股不在新一期Top K時強制賣出，買入新選股  
- **風險控制**：日漲跌幅超過±9.6%時暫停交易判斷

## 交易成本

- 交易稅：0.1%  
- 滑價成本：買賣各0.3%  

## 績效指標

| 指標 | 定義 |
|------|------|
| CAGR | 年化報酬率 |
| MaxDD | 最大回撤(%) |
| Calmar | CAGR / \|MaxDD\| |
| WinRate | 獲利交易佔比 |

## 參數說明

| 參數 | 範圍 | 說明 |
|------|------|------|
| n_days | 2~20日 | 報酬率計算週期(可複數) |
| top_k | 2~4檔 | 最大持股數 |
| v_bar | 7~11千萬 | 成交量下限 |
| pct_stp | 6~10% | 停損幅度 |
| bias60_bar | 80~84% | 乖離率上限濾網 |

## 最佳化方法

採蟻群演算法(ACO)自動搜尋最佳參數組合，以Calmar + 5×CAGR作為適應度函數，記錄前N名結果供參數高原分析。

## 輸出結果

- 初始本金：2,000萬元
- Excel結果檔含：策略摘要、交易明細、權益曲線、每日持倉、每日候選名單
- 權益曲線圖表(含回撤視覺化)
